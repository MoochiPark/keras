

# Part 02. 딥러닝 개념잡기



## Chapter 05. 평가 이야기

모델을 평가한다고 하면 정확도라는 단어만 떠올리기 쉽지만 정확도로만 평가하기 힘든 경우가 있다.
몇가지 문제와 모델을 정의하고 여기에 적합한 평가 기준이 무엇인지 알아보자. 

### 분류 하기

> 아래 레고 블록 중 상단 돌기의 수가 홀수인 것을 골라 왼쪽으로 두고, 짝수는 오른쪽으로 두어라.

![classification](http://tykimos.github.io/warehouse/2017-5-22-Evaluation_Talk_classification_1.jpg)

위 그림 중 홀수와 짝수는 몇개일까? 우리가 평가할 모델이 아래처럼 6개라 생각해보자.



![classification](http://tykimos.github.io/warehouse/2017-5-22-Evaluation_Talk_classification_2.png)

결과는 보는 것처럼 A모델이 가장 좋다. 다음으로 좋은 모델은 무엇일까?

- B모델 : 모두 홀수로 분류
- C모델 : 모두 짝수로 분류
- D모델 : 홀수라고 분류한 것에는 홀수만 있지만, 일부 홀수를 놓침
- E모델 : 짝수라고 분류한 것에는 짝수만 있지만, 일부 짝수를 놓침
- F모델 : 홀짝이 모두 섞여있음



일단 흔히 말하는 정확도로 먼저 평가해보자.



#### 정확도

정확도란 전체 개수 중 양성을 양성<sup>홀수, 왼쪽</sup>이라고, 음성<sup>짝수, 오른쪽</sup>을 음성이라고 맞춘 개수의 비율이다.

![classification](http://tykimos.github.io/warehouse/2017-5-22-Evaluation_Talk_classification_3.png)

정확도는 무조건 한 쪽으로 분류하더라도 클래스의 분포에 따라 높게 나올 수 있다.
남고에서 남녀를 구분하는 모델에서 무조건 남자인 결과를 내놓는 모델이 정확도가 90%가 넘어도 
이 모델을 좋다고 할 수 없다. 따라서 정확도를 평가할 때는 클래스의 분포를 확인해야 한다.



#### 민감도

민감도는 양성에 얼마나 민감한지를 나타낸다. 양성을 양성이라고 판정을 잘 할수록 높아진다.

> 민감도 = 판정한것 중 실제 양성 수 / 전체 양성 수

![image](https://user-images.githubusercontent.com/43429667/79831055-a6f25100-83e1-11ea-97fb-97b90bef0986.png)

정확도가 동일한 모델 중에 홀수를 잘 골라내는 모델을 선정하고 싶다면 민감도가 높은 것을 선택하면 된다.
하지만 모두 홀수라고 판정하는 모델의 민감도도 100%이므로 우리는 홀수를 홀수라고 판정을 잘 하길 바라므로
특이도라는 항목이 필요하다.



#### 특이도

특이도는 얼마나 특이한 것만 양성으로 골라내는지를 나타낸다.
즉 특이한 것만 양성으로 골라내니 반대로 음성을 음성이라고 잘 판정한다고 볼 수 있다.

> 특이도 = 판정한 것 중 실제 음성 수 / 전체 음성 수

![image](https://user-images.githubusercontent.com/43429667/79831725-ea00f400-83e2-11ea-9e36-bafb62c5c65a.png)



지금까지 본 모델을 표로 비교해보자.

|        구분         | 모델 A | 모델 B | 모델 C | 모델 D | 모델 E | 모델 F |
| :-----------------: | -----: | -----: | -----: | -----: | -----: | -----: |
| 맞춘 홀수(전체 4개) |    4개 |    4개 |    0개 |    2개 |    4개 |    2개 |
| 맞춘 짝수(전체 6개) |    6개 |    0개 |    6개 |    6개 |    4개 |    4개 |
|       정확도        |   100% |    40% |    60% |    80% |    80% |    60% |
|       민감도        |   100% |   100% |     0% |    50% |   100% |    50% |
|       특이도        |   100% |     0% |   100% |   100% |  66.6% |  66.6% |

어떤 모델이 적합한 지는 문제에 따라 다르다. 예를 들어서 살펴보자.

- 공항 검색기는 일반물건을 위험물건이라고 오판하더라도 위험물건은 반드시 찾아야 한다. = 민감도가 높아야 한다.

- 쇼핑 시에는 꼭 필요한 물건만 구입해야 한다. 
  사야할 물건을 못 사더라도 사지 않아야 하는 물건은 반드시 사지 말아야 한다. = 특이도가 높아야 한다.

- A는 민감해서 지진도 아닌 진동도 느끼지만 왠만한 지진은 모두 느낀다.
  B는 정말 강도가 강한 지진이 아니고서야 왠만해서 느끼지 못한다.

  A는 민감도가 높아 왠만한 지진은 다 알아내므로 A가 지진을 못 느꼈다고 하면 그날은 지진이 발생하지 않은 것이다.
  B는 특이도가 높아 정말 확신하는 것만 지진이라고 얘기한다. B가 지진을 느꼈다고 하면 그날은 지진이 발생한 것이다.



### 검출 및 검색 하기

> 아래 레고 블록 중 상단 돌기의 수가 하나인 것만 골라 왼쪽으로 놔두어라.

![detection](http://tykimos.github.io/warehouse/2017-5-22-Evaluation_Talk_object_detection_1.jpg)



![detection](http://tykimos.github.io/warehouse/2017-5-22-Evaluation_Talk_object_detection_2.png)

결과는 보다시피 A 모델이 가장 좋다. 

- B모델 : 하나인 것을 모두 골랐지만 아닌 것도 있음
- C모델 : 모두 하나인 것이라고 고름
- D모델 : 하나인 것이라고 고른 것 중 진짜 하나인 것은 없음
- E모델 : 하나라고 고른 것은 모두 진짜이나 하나인 것을 모두 고르지는 못함
- F모델 : 하나인 것을 모두 고르지 못했고, 고른 것들에도 진짜가 아닌 것도 있음

A 모델과 B 모델 중 어느 것이 더 좋을까? B 모델은 하나가 아닌 것도 포함되어 있다.
이를 구분하기 위한 기준으로 정밀도라는 것을 사용한다.



#### 정밀도

정밀도는 모델이 얼마나 정밀한지를 나타낸다. 즉 진짜 양성만을 잘 고를 수록 높아진다.

> 정밀도 = 실제 양성 수 / 양성이라고 판정한 수

![detection](http://tykimos.github.io/warehouse/2017-5-22-Evaluation_Talk_object_detection_3.png)

E 모델보다 A 모델이 더 좋은 성능을 가지고 있지만 정밀도만으로는 성능 차이를 나타낼 수 없다.

따라서 재현율이라는 기준을 사용한다.



#### 재현율

재현율은 양성인 것을 놓치지 않고 골라내는지를 나타낸다. 양성을 많이 고를수록 재현율이 높다.

> 재현율 = 검출 양성 수 / 전체 양성 수

![detection](http://tykimos.github.io/warehouse/2017-5-22-Evaluation_Talk_object_detection_4.png)

E 모델과 F 모델을 비교했을 때 재현율은 같지만 정밀도가 다르므로 E 모델이 더 좋은 성능을 가졌다고 볼 수 있다. 

지금까지 본 검출 모델을 표로 비교해보자.

|          구분          | 모델 A | 모델 B | 모델 C | 모델 D | 모델 E | 모델 F |
| :--------------------: | -----: | -----: | -----: | -----: | -----: | -----: |
|       총 검출 수       |    5개 |   10개 |   15개 |    5개 |    2개 |    5개 |
| 맞춘 양성 수(전체 5개) |    5개 |    5개 |    5개 |    0개 |    2개 |    2개 |
|         정밀도         |   100% |    50% |    33% |     0% |   100% |    40% |
|         재현율         |   100% |   100% |   100% |     0% |    40% |    40% |

그렇다면 검출 문제는 분류 모델과 어떤 차이가 있을까?
검출 문제에서는 검출되지 않은 진짜 음성에 대해서는 관심이 없다는 점이 가장 큰 차이점이다.



### 결론

임의의 모델의 결과를 기초적인 기준 몇가지로 평가해보았는데, 왜 이런 평가 기준들이 나왔는지를 곰곰히 생각해보고
계산해보면 자신이 개발하는 딥러닝 모델을 발전시킬 수 있을 것이다.

